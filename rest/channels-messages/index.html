<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Ably API Documentation - Channels and Messages</title>
    <link rel="shortcut icon" href="/assets/favicon.ico">

    <link rel="stylesheet" type="text/css" href="/assets/vendor/prettify/prettify.css" media="screen">
    <link rel="stylesheet" type="text/css" href="/assets/stylesheet.css" media="screen">

    <script src="/assets/vendor/javascripts/jquery-1-8-3-min.js" type="text/javascript"></script>
    <script src="/assets/vendor/javascripts/jquery-cookie-1-3-1.js" type="text/javascript"></script>
    <script src="/assets/vendor/javascripts/base64.js" type="text/javascript"></script>

    <script src="/assets/vendor/prettify/prettify-lib.js" type="text/javascript"></script>

    <script src="//cdn.ably.io/lib/ably.min.js" type="text/javascript"></script>

    <script src="/assets/javascripts/application.js" type="text/javascript"></script>
    <script src="/assets/javascripts/lang-manager.js" type="text/javascript"></script>

    <!-- you don't need to keep this, but it's cool for stats! -->
    <meta name="generator" content="nanoc 3.7.5">
  </head>
  <body>
    <div class="canonical-notice">
      <img src="/assets/icon-alert.png">
      <span class="canonical-notice-text">
        You are viewing our bleeding edge unstable documentation. We recommend you use of our <a href="https://www.ably.io/documentation">stable documentation »</a>
      </span>
      <img src="/assets/icon-alert.png">
    </div>
    <div class="fork-banner"><a href="https://github.com/ably/docs"><img src="/assets/forkme.png" alt="Fork me on GitHub"></a></div>

  <div id="documentation">
    
      <nav class="jump-to-nav">
        <div class="form">
          <select id="jump-to-nav">
            <option>Jump to ...</option>
            <optgroup label='Help with'>
<option id="anchor-help-join">Joining a channel</option>
<option id="anchor-help-publish">Publishing messages</option>
</optgroup>
<optgroup label='API Reference'>
<option id="anchor-channel-object">Channel object</option>
<option id="anchor-publish">publish</option>
<option id="anchor-history">history</option>
<option id="anchor-presence">presence</option>
</optgroup>
          </select>
        </div>
      </nav>
    
    <header>
      
        <div class="breadcrumb"><a href="/rest/">REST Client Library API</a><span class="separator">/</span></div>
      
      
        <h1 id="title">Channels and Messages</h1>
      
    </header>
    <article>
      <p>The Ably Realtime service organises the traffic within any application into named channels. Channels are the &#8220;unit&#8221; of message distribution; clients attach to channels to subscribe to messages, and every message broadcast by the service is associated with a unique channel.</p>
<h3>Channels in the REST API</h3>
<h4>Obtaining a channel instance</h4>
<p>A <code>Channel</code> object is a reference to a single channel. A channel instance is obtained from the <code>channels</code> collection of the Ably <code>Rest</code> instance.</p>
<pre lang="javascript"><code lang="javascript">var channel = rest.channels.get('myChannel');</code></pre>
<pre lang="nodejs"><code lang="nodejs">var channel = rest.channels.get('myChannel');</code></pre>
<pre lang="java"><code lang="java">import io.ably.realtime.Channel;
Channel channel = rest.channels.get("myChannel");</code></pre>
<p>A set of <a href="#channel-options">channel options</a> may also be passed when getting a channel instance.</p>
<pre lang="javascript"><code lang="javascript">var channel = rest.channels.get('myChannel', channelOpts);</code></pre>
<pre lang="nodejs"><code lang="nodejs">var channel = rest.channels.get('myChannel', channelOpts);</code></pre>
<pre lang="java"><code lang="java">import io.ably.rest.Channel;
Channel channel = rest.channels.get("myChannel", channelOpts);</code></pre>
<h3>Channel namespaces</h3>
<p>One or more channel namespaces, or channel name prefixes, may be configured for an app. When a channel is created whose name is prefixed with one of the namespaces, the channel assumes certain configured attributes associated with that namespace.</p>
<p>Namespace-prefixed names are delimited by a single colon &#8216;:&#8217;; the first component of the channel name (from the start up to and including the last character before the colon) is the namespace. A channel name may validly contain a colon even if the namespace component does not correspond to a namespace; also, a channel may contain multiple colons and only the component up to the first colon will be matched with a namespace. The only restriction on channel names is that a channel name may not start with a colon and may not be empty.</p>
<p>Namespaces are defined and configured via the application dashboard. Namespace attributes that can be configured are:</p>
<ul>
	<li>whether or not channels belonging to that namespace require clients to be authenticated;</li>
	<li>whether or not channel messages are persisted;</li>
	<li>whether or not clients are required to be connected over a TLS connection.</li>
</ul>
<p>Key or token capabilities can also specify access rights based on channel namespace.</p>
<h2>Messages</h2>
<p>An Ably Realtime Message has a <code>data</code> member carrying the payload of the message. Various primitive and object types are portably defined and supported in all clients, enabling clients to be interoperable despite being hosted in different languages or environments.</p>
<p>The supported payload types are primitive types (boolean, int32, double, string), JSON-encoded objects and arrays, and buffers containing arbitrary binary data. Client libraries detect the supplied message payload and encode the message appropriately.</p>
<h3>Publishing messages</h3>
<p>Channels expose a <code>publish</code> method whereby a client can publish either a single message or an array of messages to a channel. A listener optionally passed in to the <code>publish</code> method enables the client to know whether or not the operation succeeded.</p>
<pre lang="javascript"><code lang="javascript">channel.publish("myEvent", "This is my message", function(err) {
  if(err)
    console.log('Unable to publish message; err = ' + err.message);
  else
    console.log('Message successfully sent');
});</code></pre>
<pre lang="nodejs"><code lang="nodejs">channel.publish("myEvent", "This is my message", function(err) {
  if(err)
    console.log('Unable to publish message; err = ' + err.message);
  else
    console.log('Message successfully sent');
});</code></pre>
<pre lang="java"><code lang="java">import io.ably.rest.CompletionListener;
channel.publish("myEvent", "This is my message", new CompletionListener() {
	@Override
	public void onError(ErrorInfo reason) {
		System.out.println("Unable to publish message; err = " + reason.message);
	}
	@Override
	public void onSuccess() {
		System.out.println("Message successfully sent");
	}
});</code></pre>
<h3>Retrieving message history</h3>
<p>Channels expose a <code>history</code> method whereby a client can obtain messages previously sent on  those channels that have persistence enabled.</p>
<p>History results are paginated and therefore accompanied with one or more relative links relating to the current query. Where the number of results returned exceeds the query limit &#8211; which is either the value of the <code>limit</code> param or the default limit of 100 &#8211; the query result contains pages with the limited number of records, and a relative link to the next page.</p>
<pre lang="javascript"><code lang="javascript">var params = {direction: 'backwards', limit: '100'};
channel.history(params, function(err, messages, rel) {
  if(err) {
    console.log('Unable to get channel history; err = ' + err.message);
  } else {
    console.log(messages.length + ' messages received in first result');
    if(rel &amp;&amp; rel.next) {
      channel.history(rel.next, function(...) { ... });
    }
});</code></pre>
<pre lang="nodejs"><code lang="nodejs">var params = {direction: 'backwards', limit: '100'};
channel.history(params, function(err, messages, rel) {
  if(err) {
    console.log('Unable to get channel history; err = ' + err.message);
  } else {
    console.log(messages.length + ' messages received in first result');
    if(rel &amp;&amp; rel.next) {
      channel.history(rel.next, function(...) { ... });
    }
});</code></pre>
<pre lang="java"><code lang="java">import io.ably.types.Message;
import io.ably.types.Param;
import io.ably.types.PaginatedResult;
Param[] params = new Param[] {
  new Param("direction", "backwards"),
  new Param("limit", 100)
};
PaginatedResult&lt;Message&gt; messages = channel.history(params);
System.out.println(messages.asArray().length + " messages received in first result");
if(messages.getNext()) {
  PaginatedResult&lt;Message&gt; nextPage = channel.history(messages.getNext());
  System.out.println(...);
}</code></pre>
<p>See the <a href="/rest/history">history</a> documentation for further details of the supported query parameters.</p>
<h2>Presence</h2>
<p>Channels expose a <code>presence</code> member which a client can use to obtain channel presence information. See the <a href="/rest/presence">presence</a> documentation for details.</p>
<h1>API Reference</h1>
<div class="inline-toc">
<ul><li>Channels and messages reference
<ul>
<li>
Methods
<ul>
<li><a href='#publish-data'>publish(name, data)</a></li>
<li><a href='#publish-msg'>publish(message)</a></li>
<li><a href='#publish-msg-array'>publish(messages)</a></li>
<li><a href='#history'>history()</a></li>
</ul>
</li>
<li>
Members
<ul>
<li><a href='#members'>name</a></li>
<li><a href='#members'>presence</a></li>
</ul>
</li>
<li>
Related types
<ul>
<li><a href='#message'>Message</a></li>
<li><a href='#message-listener'>MessageListener</a></li>
<li><a href='#completion-listener'>CompletionListener</a></li>
<li><a href='#channel-options'>ChannelOptions</a></li>
</ul>
</li>
</ul>
</li></ul>
</div><h2>Methods</h2>
<h6 id="publish">publish</h6>
<blockquote class="definition">
<p class="definition"><span lang='nodejs'>channel.publish(event, data, callback)</span><span lang='ruby'>channel.publish(event, data) → success</span><span lang='java'>channel.publish(String event, Object data) → Boolean success</span></p>
</blockquote>
<p>This call queries the REST <a href="/rest-api#publish"><code>channels/&lt;channel id&gt;/publish</code></a> API.</p>
<h4>Parameters</h4>
<dl>
	<dt>event</dt>
	<dd>the name of the event to publish</dd>
	<dt>data</dt>
	<dd>the message payload</dd>
	<dt><div lang="nodejs">callback</div></dt>
	<dd>is a function of the form: <code>callback(err, result)</code><br />
where:<br />
<ul><br />
<li><code>err</code> contains an error value on the case of an error response as defined in the <a href="/rest-api#common">REST API</a> documentation</li><br />
<li>On success, <code>result</code> contains the object returned in the response body, which may be empty.</li><br />
</ul></dd>
</dl>
<div lang="ruby,java">
<h4>Returns</h4>
<p>Returns <code>true</code> if successful.  Failure to publish will raise an exception &#8211; typical publishing exceptions include:</p>
<div lang="ruby">
<ul>
	<li><code>Ably::NetworkUnavailableException</code></li>
	<li><code>Ably::QuotaExceededException</code></li>
	<li><code>Ably::AuthenticationFailureException</code><br />
  </div><div lang="java"></li>
</ul>
<ul>
	<li><code>Ably.NetworkUnavailableException</code></li>
	<li><code>Ably.QuotaExceededException</code></li>
	<li><code>Ably.AuthenticationFailureException</code><br />
  </div></li>
</ul>
</div>
<h6 id="history">history</h6>
<blockquote class="definition">
<p class="definition"><span lang='nodejs'>channel.history(params, callback)</span><span lang='ruby'>channel.history(options) → json_result</span><span lang='java'>public PaginatedResult&lt;Message&gt; history(Param[] params)</span></p>
</blockquote>
<p>Get message history for this channel.</p>
<h4>Parameters</h4>
<dl>
	<dt>params</dt>
	<dd>an optional object containing the query parameters, as specified in the <a href="/realtime/history">history</a> API documentation.</dd>
	<dt><div lang="nodejs,javascript">callback</div></dt>
	<dd>is a function of the form: <code>callback(err, messages, relParams)</code><br />
where:<br />
<ul><br />
<li><code>err</code> contains an error value on the case of an error response as defined in the <a href="/rest-api#common">REST API</a> documentation</li><br />
<li>on success, <code>messages</code> contains the query result as an array of Message objects.</li><br />
<li>where applicable, <code>relParams</code> is a map containing query params for each of the pagination links in the query response (see below).</li><br />
</ul></dd>
</dl>
<p>Further details of the supported query params are in the <a href="/rest/history">history API</a> documentation.</p>
<div lang="java">
<h4>Returns</h4>
<p>On success, the returned <a href="#paginated-result">PaginatedResult</a> encapsulates a collection of <code>Message</code> objects corresponding to the current page of results, and also provides query parameters for any applicable related (eg <code>first</code> or <code>next</code> result pages).</p>
<p>Failure to retrieve the history will raise an <code>AblyException</code>.</p>
<p></div><div lang="ruby"><br />
h4. Returns</p>
<p>On success, <span lang="ruby"><code>json_result</code></span> contains an array of results whose type corresponds to the result type for the request granularity as specified in <a href="/rest-api/#message-history">REST API</a>.</p>
<p>Example <span lang="ruby"><code>json_result</code></span>:</p>
<pre lang="json"><code lang="json">[{
  "name": "&lt;event name&gt;",
  "channel": "&lt;channel id&gt;",
  "data": "&lt;message payload&gt;",
  "timestamp": "&lt;message timestamp&gt;"
}]</code></pre>
<p>Failure to retrieve the history will raise an exception &#8211; typical exceptions include:<br />
  <div lang="ruby"></p>
<ul>
	<li><code>Ably::NetworkUnavailableException</code></li>
	<li><code>Ably::QuotaExceededException</code></li>
	<li><code>Ably::AuthenticationFailureException</code><br />
  </div></li>
</ul>
<p></div><div lang="nodejs,javascript"></p>
<h4>Pagination</h4>
<p>A paginated result is indicated in the <code>relParams</code> callback argument. For each available link, <code>relParams</code> contains a map of params to pass to a subsequent <code>history()</code> call.<br />
  Example <code>relParams</code>:<br />
  <pre lang="json"><code>[{
    "first": {"start": 1380794880000, "end": 138079488105, ...},
    "current": {"start": 1380794880000, "end": 138079488105, ...},
    "next": {"start": 1380794880000, "end": 138079488105, ...}
  }]</code></pre></p>
<p>Further details of the paginated response are in the <a href="/realtime/history">history API</a> documentation.</p>
</div>
<h6 id="presence">presence</h6>
<blockquote class="definition">
<p class="definition"><span lang='nodejs'>channel.presence(options, callback)</span><span lang='ruby'>channel.presence(options) → json_result</span><span lang='java'>channel.presence(OptionsHash options) → JSONResult</span></p>
</blockquote>
<p>This call queries the REST <a href="/rest-api#channel-presence"><code>channels/&lt;channel id&gt;/presence</code></a> API.</p>
<h4>Parameters</h4>
<dl>
	<dt>options</dt>
	<dd>an optional object containing the query parameters, as specified in the <a href="/rest-api#channel-presence">REST API</a>.</dd>
	<dt><div lang="nodejs">callback</div></dt>
	<dd>is a function of the form: <code>callback(err, result)</code><br />
where:<br />
<ul><br />
<li><code>err</code> contains an error value on the case of an error response as defined in the <a href="/rest-api#common">REST API</a> documentation</li><br />
<li>On success, <code>result</code> contains an array of results whose type corresponds to the result type for the request granularity as specified in <a href="/rest-api#channel-presence">REST API</a>.<br />
  Example <code>result</code>:<br />
  <pre lang="json"><code>[{
    "an example": "&lt;needs to be inserted here&gt;",
    "illustrating": "&lt;a simple presence result&gt;"
  }]</code></pre><br />
</li><br />
</ul></dd>
</dl>
<div lang="ruby,java">
<h4>Returns</h4>
<p>On success, <span lang="ruby"><code>json_result</code></span><span lang="java"><code>JSONResult</code></span> contains an array representing each client present on the channel as specified in <a href="/rest-api#channel-presence">REST API</a>.</p>
<p>Example <span lang="ruby"><code>json_result</code></span><span lang="java"><code>JSONResult</code></span>:</p>
<pre lang="json"><code lang="json">[{
    "an example": "&lt;needs to be inserted here&gt;",
    "illustrating": "&lt;a simple presence result&gt;"
  }]</code></pre>
<p>Failure to retrieve the presence will raise an exception &#8211; typical exceptions include:<br />
  <div lang="ruby"></p>
<ul>
	<li><code>Ably::NetworkUnavailableException</code></li>
	<li><code>Ably::QuotaExceededException</code></li>
	<li><code>Ably::AuthenticationFailureException</code><br />
  </div><div lang="java"></li>
</ul>
<ul>
	<li><code>Ably.NetworkUnavailableException</code></li>
	<li><code>Ably.QuotaExceededException</code></li>
	<li><code>Ably.AuthenticationFailureException</code><br />
  </div></li>
</ul>
</div>
<h2 id="message">Message</h2>
<p>A <code>Message</code> encapsulates an individual message sent or received in Ably. A message has the following members.</p>
<dl>
	<dt><span lang="java">String</span>name</dt>
	<dd>The event name for the message. The name may be used to allow listeners to subscribed selectively for only a subset of the messages on the channel.</dd>
</dl>
<dl>
	<dt><span lang="java">Object</span>data</dt>
	<dd>The payload of the message. The data may be one of the supported payload datatypes.</dd>
</dl>
<dl>
	<dt><span lang="java">String</span>clientId</dt>
	<dd>The clientId of the client that published the message. This <span lang="default">property</span><span lang="java">field</span> is populated by the system, where the clientId is known, for messages delivered to subscribers. It is not required to populate the clientId of a message before publishing it.</dd>
</dl>
<dl>
	<dt><span lang="java">long</span>timestamp</dt>
	<dd>The system timestamp of the message, in milliseconds since the epoch. This <span lang="default">property</span><span lang="java">field</span> is populated by the system for messages delivered to subscribers. It is not required to populate the timestamp of a message before publishing it.</dd>
</dl>
<h2 id="channel-options">ChannelOptions</h2>
<p>A <code>ChannelOptions</code> may optionally be specified when instancing a Channel, and this may be used to specify channel-specific options.</p>
<p>Currently the only supported channel options are encryption-related.</p>
<dl>
	<dt><span lang="java">public boolean</span>encrypted</dt>
	<dd>Requests encryption for this channel.</dd>
</dl>
<dl>
	<dt><span lang="java">public Object</span>cipherParams</dt>
	<dd>Specifies encryption-related parameters (such as algorithm, chaining mode, key length and key). Default cipher params for the implementation may be obtained by calling <code>Crypto.getDefaultParams()</code>.</dd>
</dl>
<div lang="java">
<h2 id="paginated-result">PaginatedResult</h2>
<p>A <code>PaginatedResult</code> is an interface that represents the result of a query that supports pagination. An instance of <code>PaginatedResult</code> encapsulates a collection of <code>Message</code> objects representing the current page of results, and provides the means &#8211; in the form of <code>Param[]</code> to perform queries for subsequent or related pages.</p>
<dl>
	<dt>public Message[] asArray()</dt>
	<dd>Returns the current page of results as an Array.</dd>
	<dt>public List&lt;Message&gt;</dt>
	<dd>Returns the current page of results as a List.</dd>
	<dt>public Param[] getFirst()</dt>
	<dd>Returns the params to pass to a <code>history()</code> call to reproduce the first call in this paginated sequence.</dd>
	<dt>public Param[] getCurrent()</dt>
	<dd>Returns the params to pass to a <code>history()</code> call to reproduce the current call in this paginated sequence.</dd>
	<dt>public Param[] getNext()</dt>
	<dd>Returns the params to pass to a <code>history()</code> call to reproduce the next call in this paginated sequence.</dd>
</dl>
</div>
    </article>
    <hr class="back">
    <a href="#documentation">Back to top</a>
  </div>
  <div id="sidebar">
  <a href="/" title="API Documentation Home"><img src="/assets/ably-logo.png" class="ably-logo" title="API Documentation Home"></a>
  <ul>
<li class=''><a href='/quick-start-guide/'>Quickstart Guide</a></li>
<li class=''><a href='/how-ably-works/'>How Ably works</a></li>
</ul>
  <h2><a href="/realtime/">Realtime client lib</a></h2>
<ul>
<li class=''><a href='/realtime/usage/'>Using the Realtime library</a></li>
<li class=''><a href='/realtime/connection/'>Connection</a></li>
<li class=''><a href='/realtime/channels-messages/'>Channels and Messages</a></li>
<li class=''><a href='/realtime/presence/'>Presence</a></li>
<li class=''><a href='/realtime/authentication/'>Authentication</a></li>
<li class=''><a href='/realtime/history/'>History</a></li>
<li class=''><a href='/realtime/statistics/'>Statistics</a></li>
<li class=''><a href='/realtime/types/'>Types</a></li>
</ul>
  <h2><a href="/rest/">REST client lib</a></h2>
<ul>
<li class=''><a href='/rest/usage/'>Using the REST library</a></li>
<li class='selected'><a href='/rest/channels-messages/'>Channels and Messages</a></li>
<li class=''><a href='/rest/presence/'>Presence</a></li>
<li class=''><a href='/rest/authentication/'>Authentication</a></li>
<li class=''><a href='/rest/history/'>History</a></li>
<li class=''><a href='/rest/statistics/'>Statistics</a></li>
<li class=''><a href='/rest/encryption/'>Encryption</a></li>
</ul>
  <h2><a href="/rest-api/">REST API</a></h2>
<ul>
</ul>
  <h2>General</h2>
<ul>
<li class=''><a href='/general/authentication/'>Authentication</a></li>
<li class=''><a href='/general/channel-rules-namespaces/'>Channel Rules and Namespaces</a></li>
<li class=''><a href='/general/webhooks/'>Receiving Webhooks</a></li>
<li class=''><a href='/general/statistics/'>Application Statistics</a></li>
<li class=''><a href='/general/migrating/'>Migrating to Ably</a></li>
</ul>
  <h2><a href="/client-lib-development-guide/">Library Development</a></h2>
<ul>
<li class=''><a href='/client-lib-development-guide/features/'>Features spec v0.8</a></li>
<li class=''><a href='/client-lib-development-guide/feature-prioritisation/'>Feature prioritisation</a></li>
<li class=''><a href='/client-lib-development-guide/protocol/'>Realtime Protocol Definition</a></li>
<li class=''><a href='/client-lib-development-guide/rest-api/'>REST API Definition</a></li>
<li class=''><a href='/client-lib-development-guide/test-api/'>Sandbox Test API</a></li>
<li class=''><a href='/client-lib-development-guide/encryption/'>Encryption</a></li>
<li class=''><a href='/client-lib-development-guide/websocket/'>WebSocket Transport</a></li>
<li class=''><a href='/client-lib-development-guide/comet/'>Comet Transport</a></li>
<li class=''><a href='/client-lib-development-guide/connection-recovery/'>Connection Recovery</a></li>
<li class=''><a href='/client-lib-development-guide/connection-manager/'>Connection Manager</a></li>
<li class=''><a href='/client-lib-development-guide/connection-fallback/'>Connection host fallback</a></li>
<li class=''><a href='/client-lib-development-guide/documentation-formatting-guide/'>Documentation Formatting Guide</a></li>
<li class=''><a href='/code-index/'>Code Examples List</a></li>
</ul>
  <ul>
<li><a href="https://www.ably.io">Visit Ably.io</a></li>
</ul>
</div>

</body>
</html>
